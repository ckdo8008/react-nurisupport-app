# 매크로
녹화된 설정/제어 신호를 편집하거나 반복 수행하기 위한 기능을 제공합니다.
매크로는 사전에 정의된 함수를 호출하여 장비의 설정이나 제어를 처리합니다.
**매크로는 각 행 단위로 명령어를 처리합니다.**
매크로의 녹화는 유휴시간까지 기록하지 않습니다. 
단축키가 정의된 매크로는 연결 상태에서 순차적으로 실행됩니다.
![34_macro](./Images/34_macro.png)

도움말 메뉴에서 저장된 매크로를 파일로 Export/Import 가능합니다.
작성한 매크로를 공유하세요.

### 로그뷰어
![logview](./Images/13_Logview.png)
처리 중인 프로토콜 및 진행상황을 볼 수 있는 로그뷰어의 표기 여부를 선택합니다.
<br>
### 처리중단
![35_stop](./Images/35_stop.png)
진행 중인 매크로에 대해서 처리를 중지합니다.
여러 매크로를 한꺼번에 실행하거나 하나의 매크로를 많이 실행해서 문제가 발생할 경우 중단할 수 있습니다.
<br>
### 매크로
![36_macro](./Images/36_macro.png)
저장 혹은 작성한 매키로를 편집 또는 실행합니다.
매크로 키를 확인할 수 있습니다.

#### 실행
해당 매크로를 실행합니다.
<br>
#### 편집
![37_macroedit](./Images/37_macroedit.png)
매크로를 편집합니다.
매크로 명칭을 수정할 수 있습니다.
단축키를 지정할 수 있습니다.
매크로를 삭제할 수 있습니다.
<br>
##### 테스트
현재 편집창에 내용의 동작을 테스트(실행)합니다.
<br>
##### 단축키
![38_shortcut](./Images/38_shortcut.png)
선택하단에 입력 영역을 클릭하고 시스템 단축키를 제외한 키를 입력하면 해당 키를 매크로의 단축키로 사용이 가능합니다.
수정된 단축키는 [매크로 편집]창이 반영되어야만 동작합니다.
<br>
#### 매크로 삭제
편집 중인 매크로를 삭제합니다.
<br>
#### 지연시간 추가
1초 지연시간을 커서 위치에 추가합니다.

## 매크로 프로그래밍

### 객체 추가 기능(Ctrl + Space)
매크로 편집화면 상에서는 Ctrl + Space에 대해서 객체 추가 기능을 제공합니다.
![39_classchoose](./Images/39_classchoose.png)

### 메소드 추가 기능(.)
객체 뒤에 "."을 입력하면 해당 객체의 메소드 추가 기능을 제공합니다.
![40_methodChoose](./Images/40_methodChoose.png)

### 장비 구분
* nuriRSA
* nuriMC
* nuriSM
동작에 신호는 혼용이 가능합니다만 설정의 경우엔 혼용하면 이상 동작할 수 있습니다.
매크로를 혼용하지 마시기 바랍니다.

#### nuriRSA
RSA 전문(프로토콜) 대상 클래스입니다.
스마트 액튜에이터가 해당됩니다.
설정 전문에 대해서 nuriMC에서 모토정격속도, 분해능, 제어방향이 제외되어 있습니다.
제어 전문은 동일하게 처리됩니다.

#### nuriMC
모터컨트롤로 전문(프로토콜) 대상 클래스입니다.
모터컨트롤러를 제어합니다.
설정 전문에 대해서 nuriRSA보다 모토정격속도, 분해능, 제어방향이 추가되어 있습니다.
제어 전문은 동일하게 처리됩니다.

#### nuriSM
스마트모터 대상 클래스입니다.
스마트모터를 제어합니다.
가감속 속도제어 관련 기능만 제어합니다.
지원되는 전문의 양이 가장 적습니다.

#### Thread
대기시간 객체

### 매크로 예제
#### 통신속도 변경
```
nuriRSA.SettingBaudrate(0x00, 1000000);
0번 스마트모터에 대해서 1000000 bps로 설정 변경합니다.
```
<br>
#### 속도제어
```
nuriRSA.ControlAcceleratedSpeed( 0x00, (byte)1, (float)15f, (float)1f);
```
0번 스마트모터에 대해 시계방향으로 15rpm의 속도까지 1초에 도달하도록 제어합니다.
<br>
#### 모터 정지
```
nuriRSA.ControlAcceleratedSpeed( 0x00, (byte)1, (float)0f, (float)0.1f);
```
0번 스마트모터에 대해 시계방향으로 0rpm의 속도까지 100미리초에 도달하도록 제어합니다.
<br>
#### 유휴시간 추가
```
Thread.Sleep(1000 * 10);
```
1000(ms) * 10(회) = 10초
해당 시간 동안 대기합니다.
다음 번 매크로의 실행시간은 함수 인자의 시간만큼 대기시킵니다.
<br>
#### 심화단계
매크로는 줄단위로 실행하기 때문에 제어 구문들에 대한 코딩은 원칙적으로 제한됩니다.
단, 한 줄안에 제어를 포함한 구문이 포함된 경우 동작이 가능합니다.
예제
```
for(int i=0;i<5;i++) {nuriMC.ControlAcceleratedSpeed( 0x00, (byte)1, (float)1500f, (float)1f);Thread.Sleep(1000);nuriMC.ControlAcceleratedSpeed( 0x00, (byte)1, (float)0f, (float)0.1f);Thread.Sleep(100);}
```
0번 모터컨트롤에 대해 시계방향으로 1500rpm으로 1초에 도달하게 요청하고 1초 대기(1500rpm에 도달하도록 지연) 후 0.1초 만에 정지 요청하고 0.1초 대기합니다.
상기 행위를 5회 반복합니다.
** 해당 방법은 매크로 중지 요청 시에 해당 반복문이 종료해야지만 매크로가 중단됩니다.**
